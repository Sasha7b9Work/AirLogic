[env:mfBoot]
platform = ststm32
board = mftech_alpro10
;board = test_f051

platform_packages = 
    ;toolchain-gccarmnoneeabi@1.70201.0
    ;toolchain-gccarmnoneeabi@1.90301.200702
    ;toolchain-gccarmnoneeabi@1.100301.210729
    ;toolchain-gccarmnoneeabi@1.100301.211021
    ;framework-ststm32@0.0.0
    toolchain-gccarmnoneeabi@1.90201.191206
    framework-ststm32@0.0.0


lib_archive = no
lib_compat_mode = off
framework = stm32

build_unflags = -std=gnu++11
build_flags = 
    -UTIMER_SERVO -UTIMER_TONE
    -std=gnu++17 -Os -Wno-psabi
    -fstack-protector-strong 
    -DHAL_I2C_MODULE_DISABLED -DHAL_RTC_MODULE_DISABLED -DHAL_CAN_MODULE_DISABLED
    -DHAL_DAC_MODULE_DISABLED -DHAL_PCD_MODULE_DISABLED -DHAL_ADC_MODULE_DISABLED
    -DHAL_EXTI_MODULE_DISABLED

    -DHAL_UART_MODULE_ENABLED -DENABLE_HWSERIAL1 -DENABLE_HWSERIAL2 -DENABLE_HWSERIAL3 -DENABLE_HWSERIAL4
    -DHAL_PCD_MODULE_ENABLED -DUSBD_USE_CDC -DUSBCON -DUSBD_VID=0x0483 -DUSBD_PID=0x5740
    -DUSB_MANUFACTURER_STRING=\"MFTech\" -DUSB_PRODUCT_STRING=\"AirLogic\ V10\ PRO\"

    -DHAL_SPI_MODULE_ONLY -DHAL_TIM_MODULE_ONLY 

    -DBL_LEAF_DFU -DLED_BUILTIN=PE7 -DLED_GREEN=PE7
    -DCPIN_HWFREQ=90 -DSPI_TRANSFER_TIMEOUT=100 -DCPIN_DISABLE_HWTIMER
    -DMF_QUEUE_LEN=10U -DMFPROTO_MAXDATA=256U -DMFPROTO_BUFSIZE=384U
    -DSERIAL_RX_BUFFER_SIZE=384U -DSERIAL_TX_BUFFER_SIZE=384U
    -DBL_LED=PE7 -DBL_LEDPIN=LL_GPIO_PIN_7 -DBL_LEDPORT=GPIOE -DBL_LEDLVL=CPIN_OD
;    -DBL_BUTPORT1=GPIOB -DBL_BUTPIN1=LL_GPIO_PIN_9
    -DBL_BUTPORT2=GPIOB -DBL_BUTPIN2=LL_GPIO_PIN_10
;    -DBL_BUTPORT3=GPIOB -DBL_BUTPIN3=LL_GPIO_PIN_11
    -DAES_DECRYPT -DNOHW_CRC32
    -DBL_MASTER_F405 -DBL_OFFSET=0x10000
    -DMFPROTO_MESSAGE_OWN_STORAGE=256

upload_protocol = dfu_reset
;upload_protocol = dfu
;upload_protocol = stlink
monitor_speed = 115200
debug_tool = stlink
check_tool = clangtidy
check_flags = 
    clangtidy: --checks=clang-analyzer-*,bugprone-*,performance-*,misc-*,mpi-*
;check_tool = cppcheck
;check_tool = pvs-studio
check_severity = high, medium, low
;check_severity = low